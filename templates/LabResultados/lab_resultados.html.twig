{% extends '@SonataAdmin/CRUD/action.html.twig' %}

{% block stylesheets %}
    {{ parent() }}

{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script type="text/javascript">
        $(document).ready(function(){
            $('#listarOrdenes').DataTable({
                /* 
                TRADUCIENDO EL LENGUAJE
                */
                "language" : {
                    "lengthMenu"    : "Mostrar _MENU_ registros",
                    "zeroRecords"   : "No se encontraron resultados",
                    "info"          : "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                    "infoEmpty"     : "Mostrando registros del 0 al 0 de un total de 0 registros",
                    "infoFiltered"  : "(filtrado de un todal de _MAX_ registros)",
                    "sSearch"       : "Buscar:",
                    "oPaginate"     : {
                        "sFirst"    : "Primero",
                        "sLast"     : "Ultimo",
                        "sNext"     : "Siguiente",
                        "sPrevious" : "Anterios"
                    },
                    "sProcessing"   : "Procesando...",
                }
            });

            /* 
            OCULTAR BOTOR GUARDAR
            */
           $('#btnGuardar').hide();

        });


        $(document).ready(function () {
            //buscar las ordenes de trabajo con estado pendiente de resultado.
            $('#btnBuscar').on('click', function () {
                numeroOrden = $("#numeroOrden").val()
                $.ajax({
                url: "{{ path('lab_resultados_ordenes_pendientes') }}",
                data : {numeroOrden : numeroOrden},
                type: "GET",
                dataType: "html",
                success : function (html) {
                    $("#ordenes").html(html);
                }
                });
            });
        })


        function mostrarDetalle(idOrden) {
            $(document).ready(function () {
                //buscar las ordenes de trabajo con estado pendiente de resultado.
                $.ajax({
                url: "{{ path('lab_detalles_ordenes_pendientes') }}",
                data : {idOrden : idOrden},
                type: "GET",
                dataType: "html",
                success : function (html) {
                    //console.log(html);
                    $("#examenes").html(html);
                }

                });
            })
        }


         function mostrarElementos(idExamen) {
            $(document).ready(function () {
                $('#btnGuardar').show();
                //buscar las ordenes de trabajo con estado pendiente de resultado.
                $.ajax({
                url: "{{ path('lab_detalles_elementos') }}",
                data : {idExamen : idExamen},
                type: "GET",
                dataType: "html",
                success : function (html) {
                    //console.log(html);
                    $("#elementos").html(html);
                }
                });
            })
        }

        $(document).ready(function () {
            $("#btnGuardar").on('click',function(){
                $.ajax({
                url: "{{ path('lab_detalles_guardar_elementos') }}",
                data : {datos : $('#envio').serialize()},
                type: "POST",
                dataType: "html",
                success : function (html) {
                    //console.log(html);
                    $("#message").html(html);
                }
                });
            });
        });
    </script>

{% endblock %}
{% block sonata_admin_content %}
    {#{% block notice %}
        {% include "SonataCoreBundle:FlashMessage:render.html.twig" %}
    {% endblock notice %}#}
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="box box-primary">
                    <div class="box-body">
                        <div class="row">
                            <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                <h4 class="text-primary"><strong><i class="fa fa-search" style="color:lightseagreen;"></i>  BÃºsqueda de Ordenes</strong></h4>
                                <div class="form-group">
                                    <label for="numeroOrden" class="control-label">No. Orden</label><br>
                                    <input type="text" id="numeroOrden" name="numeroOrden" class="form-control">                                            
                                </div>
                                <div class="form-group">
                                    <button type="button" id="btnBuscar" style="width: 200px; margin-top: 5px;" class="btn btn-info"><i class="glyphicon glyphicon-zoom-in"></i>&nbsp; Buscar</button>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center">
                                {# <button type="button" id="btnBuscar" style="width: 200px; margin-top: 5px;" class="btn btn-info"><i class="glyphicon glyphicon-zoom-in"></i>&nbsp; Buscar</button> #}
                            </div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                <form name="envio" method="post" id="envio">
                                    <div id="ordenes" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 center-block">
                                    </div>
                                    <div id="examenes" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 center-block">
                                    </div>
                                    <div id="elementos" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 center-block">
                                    </div>
                                    <button type="button" id="btnGuardar" style="width: 200px; margin-top: 5px;" class="btn btn-info">Guardar</button>
                                    <div id="message" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 center-block">
                                    </div>
                                </form>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center">
                                {# <button type="button" id="btnBuscar" style="width: 200px; margin-top: 5px;" class="btn btn-info"><i class="glyphicon glyphicon-zoom-in"></i>&nbsp; Buscar</button> #}
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
        
    </div>
{% endblock %}
